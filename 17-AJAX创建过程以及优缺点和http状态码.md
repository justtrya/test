# AJAX是什么？

> Ajax并不算是一种新的技术，全称是asychronous javascript and xml，可以说是已有技术的组合，主要用来实现客户端与服务器端的异步通信效果，实现页面的局部刷新，早期的浏览器并不能原生支持ajax，可以使用隐藏帧（iframe）方式变相实现异步效果，后来的浏览器提供了对ajax的原生支持
> 使用ajax原生方式发送请求主要通过XMLHttpRequest(标准浏览器)、ActiveXObject(IE浏览器)对象实现异步通信效果

---



# AJAX的创建过程



基本步骤：
```js
var xhr =null;//创建对象 
//兼容处理
if(window.XMLHttpRequest){
	xhr = new XMLHttpRequest();
}else{
	xhr = new ActiveXObject("Microsoft.XMLHTTP");
}

xhr.open("方式","地址","标志位");//初始化请求 

xhr.setRequestHeader("","");//设置http头信息 

xhr.onreadystatechange = function(){
  if (xhr.status == 200 && xhr.readyState == 4) {
  //dosomthing      
  }
}//指定回调函数 

xhr.send();//发送请求 
```
js框架（jQuery/EXTJS等）提供的ajax  API对原生的ajax进行了封装，熟悉了基础理论，再学习别的框架就会得心应手，好多都是换汤不换药的内容 。

---



# AJAX优点

1. 通过异步模式，提升了用户体验。
2. 优化了浏览器和服务器之间的传输，减少不必要的数据往返，减少了带宽占用。
3. AJAX在客户端运行，承担了一部分本来由服务器承担的工作，减少了大用户量下的服务器负载。
4. AJAX可以实现动态不刷新（局部刷新）。

> readyState属性 状态 有5个可取值： 0=未初始化 ，1=启动 2=发送，3=接收，4=完成。



---

# Ajax 解决浏览器缓存问题？

确保ajax 或连接不走缓存路径：

1. 在ajax发送请求前加上 `anyAjaxObj.setRequestHeader("If-Modified-Since","0")`。
2. 在ajax发送请求前加上 `anyAjaxObj.setRequestHeader("Cache-Control","no-cache")`。
3. 在URL后面加上一个随机数： `"fresh=" + Math.random();`。
4. 在URL后面加上时间搓：`"nowtime=" + new Date().getTime();`。
5. 如果是使用jQuery，直接这样就可以了 `$.ajaxSetup({cache:false})`。这样页面的所有ajax都会执行这条语句就是不需要保存缓存记录。


---



# AJAX的缺点

1. AJAX不支持浏览器back按钮。
2. 安全问题 AJAX暴露了与服务器交互的细节。
3. 对搜索引擎的支持比较弱。
4. 破坏了程序的异常机制。
5. 不容易调试。


---



# http状态码

### 简单版

- 100  Continue	继续，一般在发送post请求时，已发送了http header之后服务端将返回此信息，表示确认，之后发送具体参数信息
  - 200  OK 	正常返回信息
  - 201  Created  请求成功并且服务器创建了新的资源
  - 202  Accepted 服务器已接受请求，但尚未处理
- 301  Moved Permanently  请求的网页已永久移动到新位置。
  - 302 Found  	临时性重定向。
  - 303 See Other  临时性重定向，且总是使用 GET 请求新的 URI。
- 304  Not Modified 自从上次请求后，请求的网页未修改过。
- 400 Bad Request  服务器无法理解请求的格式，客户端不应当尝试再次使用相同的内容发起请求。
- 401 Unauthorized 请求未授权。
  - 403 Forbidden  禁止访问。
  - 404 Not Found  找不到如何与 URI 相匹配的资源。
- 500 Internal Server Error  最常见的服务器端错误。
- 503 Service Unavailable 服务器端暂时无法处理请求（可能是过载或维护）。

### 完整版

- 1**(信息类)：表示接收到请求并且继续处理

        100——客户必须继续发出请求
        101——客户要求服务器根据请求转换HTTP协议版本

- 2**(响应成功)：表示动作被成功接收、理解和接受

        200——表明该请求被成功地完成，所请求的资源发送回客户端
        201——提示知道新文件的URL
        202——接受和处理、但处理未完成
        203——返回信息不确定或不完整
        204——请求收到，但返回信息为空
        205——服务器完成了请求，用户代理必须复位当前已经浏览过的文件
        206——服务器已经完成了部分用户的GET请求

- 3**(重定向类)：为了完成指定的动作，必须接受进一步处理

        300——请求的资源可在多处得到
        301——本网页被永久性转移到另一个URL
        302——请求的网页被转移到一个新的地址，但客户访问仍继续通过原始URL地址，重定向，新的URL会在response中的Location中返回，浏览器将会使用新的URL发出新的Request。
        303——建议客户访问其他URL或访问方式
        304——自从上次请求后，请求的网页未修改过，服务器返回此响应时，不会返回网页内容，代表上次的文档已经被缓存了，还可以继续使用
        305——请求的资源必须从服务器指定的地址得到
        306——前一版本HTTP中使用的代码，现行版本中不再使用
        307——申明请求的资源临时性删除

- 4**(客户端错误类)：请求包含错误语法或不能正确执行

        400——客户端请求有语法错误，不能被服务器所理解
        401——请求未经授权，这个状态代码必须和WWW-Authenticate报头域一起使用
        HTTP 401.1 - 未授权：登录失败
        HTTP 401.2 - 未授权：服务器配置问题导致登录失败
        HTTP 401.3 - ACL 禁止访问资源
        HTTP 401.4 - 未授权：授权被筛选器拒绝
        HTTP 401.5 - 未授权：ISAPI 或 CGI 授权失败
        402——保留有效ChargeTo头响应
        403——禁止访问，服务器收到请求，但是拒绝提供服务
        HTTP 403.1 禁止访问：禁止可执行访问
        HTTP 403.2 - 禁止访问：禁止读访问
        HTTP 403.3 - 禁止访问：禁止写访问
        HTTP 403.4 - 禁止访问：要求 SSL
        HTTP 403.5 - 禁止访问：要求 SSL 128
        HTTP 403.6 - 禁止访问：IP 地址被拒绝
        HTTP 403.7 - 禁止访问：要求客户证书
        HTTP 403.8 - 禁止访问：禁止站点访问
        HTTP 403.9 - 禁止访问：连接的用户过多
        HTTP 403.10 - 禁止访问：配置无效
        HTTP 403.11 - 禁止访问：密码更改
        HTTP 403.12 - 禁止访问：映射器拒绝访问
        HTTP 403.13 - 禁止访问：客户证书已被吊销
        HTTP 403.15 - 禁止访问：客户访问许可过多
        HTTP 403.16 - 禁止访问：客户证书不可信或者无效
        HTTP 403.17 - 禁止访问：客户证书已经到期或者尚未生效
        404——一个404错误表明可连接服务器，但服务器无法取得所请求的网页，请求资源不存在。eg：输入了错误的URL
        405——用户在Request-Line字段定义的方法不允许
        406——根据用户发送的Accept拖，请求资源不可访问
        407——类似401，用户必须首先在代理服务器上得到授权
        408——客户端没有在用户指定的饿时间内完成请求
        409——对当前资源状态，请求不能完成
        410——服务器上不再有此资源且无进一步的参考地址
        411——服务器拒绝用户定义的Content-Length属性请求
        412——一个或多个请求头字段在当前请求中错误
        413——请求的资源大于服务器允许的大小
        414——请求的资源URL长于服务器允许的长度
        415——请求资源不支持请求项目格式
        416——请求中包含Range请求头字段，在当前请求资源范围内没有range指示值，请求也不包含If-Range请求头字段
        417——服务器不满足请求Expect头字段指定的期望值，如果是代理服务器，可能是下一级服务器不能满足请求长。

- 5**(服务端错误类)：服务器不能正确执行一个正确的请求

      HTTP 500 - 服务器遇到错误，无法完成请求
      HTTP 500.100 - 内部服务器错误 - ASP 错误
      HTTP 500-11 服务器关闭
      HTTP 500-12 应用程序重新启动
      HTTP 500-13 - 服务器太忙
      HTTP 500-14 - 应用程序无效
      HTTP 500-15 - 不允许请求 global.asa
      Error 501 - 未实现
      HTTP 502 - 网关错误
      HTTP 503：由于超载或停机维护，服务器目前无法使用，一段时间后可能恢复正常